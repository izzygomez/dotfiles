# -*- mode: conf-mode; -*- 
################################################################################
# Notes ########################################################################
################################################################################
#
# Usage:
#
# Equally balance panes in current window:
#   Horizontally: `C-a : select-layout even-horizontal`, or `C-a M-1`
#   Vertically:   `C-a : select-layout even-vertical`, or `C-a M-2`
#
# Because mouse mode is enabled, panes can also be resized with a mouse click.
#
# Other notes:
#   - `bind` & `bind-key` are the same thing (https://superuser.com/a/582069/1697355)
#   - `-n` flag to `bind` means prefix ('C-a') is not required
#   - `set` is an alias for `set-option`, so prefer using `set`
#
################################################################################
# Configuration ################################################################
################################################################################

# Set terminal emulator to xterm-256color, & enable sending xterm-style key
# sequences in tmux windows.
set -g default-terminal "xterm-256color"
set -g xterm-keys on

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# remap prefix from 'C-b' to 'C-a'
unbind C-b
set -g prefix C-a
# 'C-a' + 'C-a' to use 'C-a' (e.g. necessary to use shortcut inside emacs)
bind-key C-a send-prefix

# create a new window with C-a C-c or C-t; default to home directory
bind c new-window -c "~" \; display-message "Consider using C-t to create a new window"
bind -n C-t new-window -c "~"

# split panes using | and -; new pane defaults to current directory
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# reload config file
bind r source-file ~/.tmux.conf \; display-message "Reloaded .tmux.conf"

# Enable mouse mode (tmux 2.1 and above).
set -g mouse on

# don't rename windows automatically
set -g allow-rename off

# allow re-ordering of tmux windows (source: https://superuser.com/questions/343572/how-do-i-reorder-tmux-windows)
bind-key Left swap-window -d -t -1
bind-key Right swap-window -d -t +1

# Make messages appear for 3 seconds
set -g display-time 3000

# Renumber windows when one is closed (source: https://stackoverflow.com/questions/8469612/how-do-i-make-tmux-reorder-windows-when-one-is-deleted
set -g renumber-windows on

# Pane scrollback buffer size (https://stackoverflow.com/questions/18760281/how-to-increase-scrollback-buffer-size-in-tmux)
set -g history-limit 50000

# Clear tmux scrollback buffer with C-k (`-n` means no need for C-a)
# https://stackoverflow.com/questions/10543684/how-do-i-clear-the-scrollback-buffer-in-tmux
#
# A sample flow could then be C-l (terminal-dependent, essentially runs `clear`)
# followed by C-k (tmux-specific).
bind -n C-k clear-history \; display-message "Cleared tmux scrollback buffer"

## Active pane configuration. See:
##   - https://tech.serhatteker.com/post/2019-06/tmux-focus/)
##   - https://github.com/tmux/tmux/wiki/FAQ#how-do-i-translate--fg--bg-and--attr-options-into--style-options
# set active-inactive window styles
# set -g window-style fg=colour247,bg=colour236
# set -g window-active-style fg=default,bg=colour234
# set -g pane-border-style fg=colour238,bg=default
# set -g pane-active-border-style fg=yellow,bg=default

# set -g window-style fg=default,bg=default
# set -g window-active-style fg=default,bg=default
# set -g pane-border-style fg=default,bg=default
# set -g pane-active-border-style fg=default,bg=default

################################################################################
# Plugins ######################################################################
################################################################################

# Tmux Plugin Manager: https://github.com/tmux-plugins/tpm
# C-a + I - install plugins
# C-a + U - update plugins
# C-a + alt/option + u - remove/uninstall plugins not on plugin list
set -g @plugin 'tmux-plugins/tpm'

# github.com/tmux-plugins/tmux-resurrect
# C-a + C-s - save current session
# C-a + C-r - restore saved session
set -g @plugin 'tmux-plugins/tmux-resurrect'

# https://github.com/seebi/tmux-colors-solarized
set -g @plugin 'seebi/tmux-colors-solarized'
# different themes are '256', 'dark', 'light', 'base16'
set -g @colors-solarized 'dark'

# https://github.com/erikw/tmux-powerline
set -g @plugin 'erikw/tmux-powerline'

# Initialize TMUX plugin manager
run -b '~/.tmux/plugins/tpm/tpm'
# NOTE: keep this line above ^^ at the very bottom of tmux.conf
